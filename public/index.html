<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Calendar Extractor">
    <title>Email Calendar Extractor</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ“…</text></svg>">
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ“… Email Calendar Extractor</h1>
            <p>Extract calendar events from your email content using AI</p>
        </header>

        <main>
            <div class="input-section">
                <label for="emailContent">Paste your email content below:</label>
                
                <div class="input-options">
                    <div class="input-tabs">
                        <button type="button" class="tab-btn active" data-tab="rich">ğŸ“§ Rich Content (HTML/Images)</button>
                        <button type="button" class="tab-btn" data-tab="plain">ğŸ“ Plain Text</button>
                        <button type="button" class="tab-btn" data-tab="file">ğŸ“ Upload File</button>
                    </div>
                </div>

                <!-- Rich content input -->
                <div id="richInput" class="input-container active">
                    <div 
                        id="richContent" 
                        class="rich-editor"
                        contenteditable="true"
                        data-placeholder="Paste your email here (supports HTML formatting, images, and rich text)..."
                    ></div>
                    <div class="input-info">
                        ğŸ’¡ <strong>Tip:</strong> Paste directly from your email client to preserve formatting, links, and images
                    </div>
                </div>

                <!-- Plain text input -->
                <div id="plainInput" class="input-container">
                    <textarea 
                        id="emailContent" 
                        placeholder="Paste the plain text body of your email here..."
                        rows="12"
                        maxlength="50000"
                    ></textarea>
                </div>

                <!-- File upload input -->
                <div id="fileInput" class="input-container">
                    <div class="file-upload-area" id="fileUploadArea">
                        <input type="file" id="fileUpload" accept=".eml,.msg,.txt,.html,.pdf" hidden>
                        <div class="upload-content">
                            <div class="upload-icon">ğŸ“</div>
                            <div class="upload-text">
                                <strong>Drop email file here or click to browse</strong>
                                <div class="upload-formats">Supports: .eml, .msg, .txt, .html, .pdf files</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="character-count">
                    <span id="charCount">0</span> / 50,000 characters
                    <div class="timezone-info">
                        <span id="timezoneDisplay">ğŸŒ Timezone: Loading...</span>
                    </div>
                </div>
            </div>

            <div class="button-section">
                <button id="extractBtn" type="button">
                    <span class="btn-text">ğŸ” Generate Calendar Event</span>
                    <span class="btn-loading" style="display: none;">â³ Processing...</span>
                </button>
                <button id="clearBtn" type="button" class="clear-btn">
                    ğŸ—‘ï¸ Clear All
                </button>
            </div>

            <div id="results" class="results-section" style="display: none;">
                <h3>ğŸ“‹ Extracted Event Details</h3>
                <div class="results-actions">
                    <button id="editBtn" class="edit-btn">âœï¸ Edit Details</button>
                    <button id="addAnotherBtn" class="add-btn" style="display: none;">â• Add Another Event</button>
                </div>
                <div id="eventDetails" class="event-details"></div>
                
                <div class="download-section">
                    <button id="downloadBtn" class="download-btn">
                        ğŸ“¥ Download .ics Calendar File
                    </button>
                    <button id="iosCalendarBtn" class="ios-calendar-btn" style="display: none;">
                        ğŸ“± Add to iPhone Calendar
                    </button>
                </div>
            </div>

            <!-- Edit Modal -->
            <div id="editModal" class="modal" style="display: none;">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>âœï¸ Edit Event Details</h3>
                        <button id="closeModal" class="close-btn">âœ•</button>
                    </div>
                    <div class="modal-body">
                        <div class="edit-field">
                            <label>ğŸ“ Title:</label>
                            <input type="text" id="editTitle" placeholder="Event title">
                        </div>
                        <div class="edit-field">
                            <label>ğŸ“… Start Date & Time:</label>
                            <input type="datetime-local" id="editStartDate">
                        </div>
                        <div class="edit-field">
                            <label>ğŸ“… End Date & Time:</label>
                            <input type="datetime-local" id="editEndDate">
                        </div>
                        <div class="edit-field">
                            <label>ğŸ“ Location:</label>
                            <input type="text" id="editLocation" placeholder="Event location">
                        </div>
                        <div class="edit-field">
                            <label>ğŸ“‹ Description:</label>
                            <textarea id="editDescription" rows="3" placeholder="Event description"></textarea>
                        </div>
                        <div class="edit-field">
                            <label>ğŸ‘¥ Attendees:</label>
                            <textarea id="editAttendees" rows="2" placeholder="Enter email addresses separated by commas (e.g., john@company.com, jane@company.com)"></textarea>
                            <small class="field-help">ğŸ’¡ These people will receive calendar invites when you import the .ics file</small>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button id="saveChanges" class="save-btn">ğŸ’¾ Save Changes</button>
                        <button id="cancelEdit" class="cancel-btn">âŒ Cancel</button>
                    </div>
                </div>
            </div>

            <div id="error" class="error-section" style="display: none;">
                <div class="error-content">
                    <h3>âŒ Error</h3>
                    <p id="errorMessage"></p>
                </div>
            </div>
        </main>

        <footer>
            <div class="security-notice">
                <h4>ğŸ”’ Security & Privacy</h4>
                <ul>
                    <li>All processing is done securely on the server</li>
                    <li>Your email content is not stored permanently</li>
                    <li>Data is transmitted over HTTPS encryption</li>
                    <li>Rate limiting prevents abuse</li>
                </ul>
            </div>
            <div class="usage-tips">
                <h4>ğŸ’¡ Tips for Best Results</h4>
                <ul>
                    <li>Include emails with clear date and time information</li>
                    <li>Meeting invitations work particularly well</li>
                    <li>Make sure location details are mentioned in the email</li>
                    <li>The AI automatically detects timezones or uses your local timezone</li>
                    <li>Dates in the past will be automatically moved to the current/next year</li>
                    <li>Multiple events in one email are automatically detected</li>
                    <li>Recurring meetings (weekly, monthly) are supported</li>
                </ul>
                
                <div class="smart-suggestions" id="smartSuggestions" style="display: none;">
                    <h4>ğŸ¤– Smart Suggestions</h4>
                    <div id="suggestionsList"></div>
                </div>
            </div>
        </footer>
    </div>

    <script src="script.js"></script>
</body>
</html> 